**Clarification on Question 3: Custody Models**
*Before answering the main research questions, here is the explanation you requested regarding custody models. This is critical for Startale because Soneium (EVM L2) and "next-gen" wallets heavily rely on Smart Accounts.*

*   **EOA (Externally Owned Account):** The traditional model (MetaMask, Ledger). The user holds a private key and signs every single action.
    *   *Trade-off:* Simple, standard, but "dumb." You cannot batch transactions (e.g., Approve + Swap require 2 separate clicks/gas fees).
*   **Smart Wallet / Account Abstraction (AA):** The model Startale/Soneium is pushing (ERC-4337). The "wallet" is actually a smart contract on the blockchain controlled by a key.
    *   *Trade-off:* Slightly more complex setup, but "smart." You can bundle transactions (Approve + Swap = 1 click), let the app pay your gas (Paymasters), and implement social recovery.
*   **Implication for your assignment:** Startale’s "Startale App" is likely an **AA/Smart Wallet**. Your swap feature should leverage this by offering **"Gasless Swaps"** (where the swap fee covers the gas) and **"One-Click Swaps"** (batching approval and execution).

***

Here is the research briefing to help you crush the Take-Home Assignment, specifically tailored to the **Startale (Astar + Soneium)** context.

### 1. How Wallets Power Swaps (The "Backend" Strategy)
Wallets almost never build their own DEXs. Instead, they integrate **Aggregator APIs** that act as a search engine for liquidity.

*   **The Industry Standard:** Most top wallets (Metamask, Rainbow, Phantom, Brave) use a **DEX Aggregator API**. This API scans all underlying DEXes (Uniswap, Curve, Balancer) to find the best price and returns the transaction data for the user to sign.
*   **Top Providers to Consider:**
    *   **Li.Fi (Recommended for Startale):** The "Aggregator of Aggregators." It is excellent for **cross-chain** swaps (crucial for bridging Astar L1 $\leftrightarrow$ Soneium L2) and aggregates DEX aggregators like 1inch and 0x.
    *   **1inch / 0x (Matcha):** The gold standards for deep liquidity on EVM chains. They will likely be the first to index Soneium DEXes (like Velodrome, Kyo Finance).
    *   **CoW Swap (Cow Protocol):** Uses "Intents" (Solvers) rather than direct routing. This offers **MEV Protection** (prevents users from getting front-run), which is a huge "safety/trust" selling point for a new wallet.
*   **Soneium Specifics:** Since Soneium is new, major aggregators might not support it on Day 1. Your "V1 Strategy" might need to be: *Use LiFi for Astar/Ethereum, but build a direct integration with **Velodrome (Superchain)** or **Kyo Finance** for Soneium until aggregators catch up.*

### 2. Fees & Economics
Wallets make money by adding a "Service Fee" on top of the quote provided by the aggregator.

*   **The Fee Model:**
    *   **Standard Rate:** **0.5% - 0.875%** per swap. (Metamask charges 0.875%; many newer wallets charge 0.5% or 0.3% to be competitive).
    *   **Tiers:** 0% fees for holders of a specific token (e.g., ASTR holders) or premium subscribers.
*   **Revenue Sharing:**
    *   Aggregators like 1inch and 0x often have **Partner Programs**. If you route volume through them, they share 30-50% of the *positive slippage* (when the trade executes at a better price than quoted) or a portion of their own surplus.
*   **Post-Collection Procedures (The "Hidden" Ops):**
    *   **The Problem:** You collect fees in the *token being sold* (e.g., 500 different random memecoins). You can't pay developers in memecoins.
    *   **The Procedure:** You need a **Treasury Script** or "Sweeper." Periodically (e.g., weekly), this script:
        1.  Aggregates all collected fee tokens.
        2.  Batches them.
        3.  Swaps them into stablecoins (USDC) or ETH.
        4.  Sends them to the company treasury multisig.

### 3. Key Risk & Safety Requirements
For a "next-gen" wallet, safety is a primary differentiator. Integrating third-party liquidity introduces risks you must mitigate.

*   **Token Safety (The "Scam" Filter):**
    *   **Token Lists:** Don't show every token. Use reputable lists (e.g., CoinGecko Top 100, Uniswap Default List, Optimism Superchain List).
    *   **Scam Detection:** Flag tokens that are "Honeypots" (cannot be sold). Tools like **GoPlus Security** or **TokenSniffer** APIs can be integrated to show a "High Risk" warning if a user tries to swap a suspicious token.
*   **Transaction Simulation (The "What If" Check):**
    *   Before the user signs, simulate the transaction using a provider like **Tenderly** or **Blowfish**.
    *   *Check:* Will this transaction actually result in the user receiving X tokens? Or will it fail/drain the wallet? If the simulation fails, disable the "Confirm" button.
*   **Slippage Protection:**
    *   **Auto-Slippage:** Default to 0.5% for major pairs (ETH/USDC) but auto-increase to 3-5% for volatile low-liquidity coins to prevent failed transactions (which cost gas).
*   **Approvals:** Use **Permit2** (Uniswap standard) where possible to avoid leaving infinite token allowances that can be exploited later.

### 4. Handling Liquidity (Deep vs. Shallow)
Your backend (the aggregator) handles the heavy lifting, but your UI must handle the edge cases.

*   **Deep Liquidity (ETH/USDC):**
    *   Aggregators use "Split Routing" (e.g., 60% via Uniswap V3, 40% via Curve) to get the best price.
*   **Stable Pairs (USDC/USDT):**
    *   The aggregator will automatically route these through **Curve** or **Uniswap V3 (0.01% pools)**. Your UI should reflect this by showing "minimal price impact."
*   **Low Liquidity / Long-Tail Assets:**
    *   **Multi-Hop:** The aggregator will route `Token A -> ETH -> USDC -> Token B` if a direct pair doesn't exist.
    *   **Price Impact Warning:** If the trade size > 2% of the liquidity pool, the price will crash. Your UI **MUST** show a big red warning: *"High Price Impact: You will lose 10% of your value on this trade."*
    *   **Partial Fills (Advanced):** Some engines (like CowSwap) allow "Partial Fills"—if you try to sell \$1M of a small token, it only sells what the market can absorb without crashing the price, and cancels the rest.

### 5. Advanced Features (Market, Limit, DCA)
Yes, modern aggregator APIs support these, and adding them makes your wallet "sticky."

*   **Limit Orders:**
    *   *How it works:* The user signs an order saying "I will sell 1 ETH for 4000 USDC." This order is stored off-chain (0 gas cost) by the aggregator (1inch/0x). When the market price hits 4000, a "Keeper" executes it on-chain.
    *   *Startale Angle:* "Gasless Limit Orders" are a great feature to pitch.
*   **DCA (Dollar Cost Average):**
    *   *How it works:* "Buy \$100 of ASTR every week."
    *   *Implementation:* This requires a **Smart Account** (which Startale has) or a specialized protocol like **CoW Swap's DCA Intents**. Since Startale/Soneium is AA-focused, you can pitch this as a "Smart Feature" where the wallet automatically executes these trades using a Session Key.
*   **Cross-Chain Swaps (The "Killer Feature"):**
    *   Since you have Astar (L1) and Soneium (L2), users will want to move assets between them. Integrating a **Bridge Aggregator** (like LiFi or Socket) allows users to "Swap USDC on Astar for ETH on Soneium" in one click. This is arguably the most important "Advanced Feature" for your specific roadmap.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/660733/96012ee1-c93f-4d9e-a6d8-d8da865577f4/Product-Manager-take-home-exam.pdf)
[2](https://rubic.exchange/blog/what-is-soneium-sonys-blockchain-explained/)
[3](https://www.binance.com/en/academy/articles/what-is-astar-network-astr)
[4](https://li.fi/knowledge-hub/brave-integrates-li-fi-to-enable-in-wallet-cross-chain-swaps/)
[5](https://miracuves.com/blog/revenue-model-of-gmx/)
[6](https://www.mettalex.ai/blog/crypto-swapping-risks-and-best-practices)
[7](https://www.binance.com/en/square/post/18927944841281)
[8](https://www.coingecko.com/en/exchanges/decentralized/astar-zkevm)
[9](https://flashift.app/blog/best-cross-chain-swap-platforms-in-2025-symbiosis-1inch-li-fi-and-rango/)
[10](https://www.fourchain.com/crypto-exchange/revenue-streams-of-crypto-exchange)
[11](https://github.com/openwallet-foundation/safe-wallet-sig/blob/main/docs/wallet-safety-guide.md)
[12](https://cryptorank.io/ecosystems/soneium)
[13](https://www.fxempire.com/crypto/categories/astar-zkevm-ecosystem)
[14](https://www.dune.com/sixdegree/dex-aggregators-comparision)
[15](https://miracuves.com/blog/revenue-models-decentralized-crypto-exchange/)
[16](https://www.ecomena.org/how-swapzone-ensures-security-in-crypto-swaps/)
[17](https://www.gate.com/learn/articles/a-beginner-s-guide-to-sony-s-new-soneium-blockchain/4358)
[18](https://astar.network/blog/exploring-astar-zkevm-ecosystem:-the-emergence-of-defi-72404)
[19](https://cow.fi/learn/what-is-the-best-dex-aggregator)
[20](https://www.debutinfotech.com/blog/cryptocurrency-exchange-revenue-models)
[21](https://www.trmlabs.com/guides/crypto-compliance-program-guide-for-financial-institutions)
[22](https://www.sony.com/en/SonyInfo/News/Press/202408/24-029E/)
[23](https://www.reddit.com/r/ethereum/comments/q8q822/ama_were_matter_labs_the_team_behind_zksync_the/)
[24](https://www.nftgators.com/sony-backed-l2-soneium-crosses-45m-tvl/)
[25](https://www.youtube.com/watch?v=mSJp9qAjq6c)
[26](https://blog.ambire.com/swap-bridge-fee-increase/)
[27](https://www.binance.com/en/square/hashtag/soneium)
[28](https://docs.astar.network/docs/learn/zkEVM/)
[29](https://www.coingecko.com/en/chains)
[30](https://thirdweb.com/learn/guides/thirdweb-smart-wallets-powered-by-account-abstraction-and-how-to-use-them)
[31](https://coincodex.com/article/78408/7-innovative-ways-wallets-can-increase-revenue-in-2026/)
[32](https://docs.soneium.org/docs/users/faq)
[33](https://github.com/1inch/cross-chain-sdk)
[34](https://defillama.com/chain/soneium)
[35](https://walllet.com/articles/account-abstraction-and-smart-contract-wallets-a-beginner-friendly-deep-dive)
[36](https://1kx.network/writing/2025-onchain-revenue-report)
[37](https://www.alchemy.com/docs/reference/soneium-api-faq)
[38](https://www.facebook.com/groups/371205290980633/posts/1098125831621905/)
[39](https://www.coingecko.com/en/chains/soneium)
[40](https://ont.io/news/https-ont-io-news-https-ont-io-news-account-abstraction-smart-wallets/)
[41](https://www.ainvest.com/news/rise-usage-driven-2025-top-altcoin-fee-revenue-leaders-2601/)